#!/bin/sh

#
# "VA SystemImager" - Copyright (C) 1999-2001 Brian Elliott Finley <brian@valinux.com>
#
# This file is: installdocs
#   This script copies all of the documentation to the filesystem.  That is,
#   everthing that resides in /usr/doc.  This script is run automatically by 
#   "install" and "installclient" but can be run by itself to install the
#   documentation only.
#


# do we want a quiet install? and do we want to run afterburner?
QUIET="false"
AFTERBURNER="yes"
for cl_option ; do
  case $cl_option in
    -q|-quiet|--quiet ) QUIET="true" ;;
    -h|-help|--help ) HELP="yes" ;;
  esac
done

if [ "$HELP" = "yes" ]
then
cat << 'EOF'
installdocs (part of VA SystemImager) version 1.4.0

Copyright (C) 1999-2001 Brian Elliott Finley <brian@thefinleys.com>
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

Usage: installdocs [OPTION]...

Options: (only one option is taken)
 -h, -help                Display this output.
 -q, -quiet               Run silently.  Return an exit status of 0 for
                          success or a non-zero exit status for failure.

Download, report bugs, and make suggestions at:  http://systemimager.org/

EOF

fi

# set some variables
PATH=/bin:/usr/bin:/sbin:/usr/sbin
PACKAGE_NAME=va-systemimager
COMMAND_PATH=`dirname $0`
test "x$COMMAND_PATH" != "x" && cd $COMMAND_PATH
INSTALL_DIR=`pwd`
VERSION=`cat $INSTALL_DIR/VERSION`
test "x$prefix" = "x" && prefix=/usr

# Set ownership properties for "install" based on whether we're doing a relocated install or not
[ "x$DESTDIR" = "x" ] && OWNERSHIP="-o root -g root" || OWNERSHIP=""

# if not run as root, install will surely fail (unless it's an RPM build)
if [ "x$DESTDIR" = "x" -a `whoami` != "root" ];then
    echo "Must be run as root!"
    exit 1
fi

# create DESTDIR (DESTDIR is needed for the RPM creation process)
if [ ! "x$DESTDIR" = "x" ]; then
    install -d -m 755 $OWNERSHIP $DESTDIR
    if [ "$?" != "0" ];then
        echo "I can't create $DESTDIR"
	exit 1
    fi
fi


### BEGIN install documentation ###
if [ "x$DESTDIR" = "x" ]; then
  [ $QUIET = "false" ] && echo "Installing files in ${prefix}/share/doc/$PACKAGE_NAME-$VERSION/"

  if [ ! -d $INSTALL_DIR/doc/manual/pdf ]; then
    echo "Maybe you need to cd into <source>/doc/manual_source/"
    echo "and run \"make pdf\" first..."
    exit 1
  fi

  if [ ! -d $INSTALL_DIR/doc/manual/html ]; then
    echo "Maybe you need to cd into <source>/doc/manual_source/"
    echo "and run \"make html\" first..."
    exit 1
  fi

  # get rid of old docs
  rm -fr ${prefix}/doc/$PACKAGE_NAME-*
  rm -fr ${prefix}/share/doc/$PACKAGE_NAME-*


  # doc/
  install -d -m 755 $OWNERSHIP ${prefix}/share/doc/$PACKAGE_NAME-$VERSION  || exit 1

  install -m 444 $OWNERSHIP $INSTALL_DIR/CHANGE.LOG	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/CHANGE.LOG || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/COPYING	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/COPYING || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/CREDITS	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/CREDITS || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/ERRATA	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/ERRATA || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/README	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/README || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/TODO	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/TODO || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/VERSION	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/VERSION || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/afterburner	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/afterburner || exit 1

  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/local.cfg	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/local.cfg || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/autoinstall.kernel.config	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/autoinstall.kernel.config || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/autoinstall.kernel.support	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/autoinstall.kernel.support || exit 1


  # doc/manual/pdf
  install -d -m 755 $OWNERSHIP ${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/pdf  || exit 1

  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/pdf/systemimager-manual.pdf	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/pdf/systemimager-manual.pdf || exit 1


  # doc/manual/html
  install -d -m 755 $OWNERSHIP ${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html || exit 1

  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/index.html	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/ || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/intro.html	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/ || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/who.html	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/ || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/sect2.html	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/ || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/sect3.html	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/ || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/howdoesitwork.html	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/ || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/terminology.html	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/ || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/overview.html	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/ || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/theactualstep-by-stephowto.html	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/ || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/designgoals.html	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/ || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/architecture.html	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/ || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/faq.html	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/ || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/docbook.css	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/ || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/systemimager-manual.sgml	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/ || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/CREDITS	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/ || exit 1


  install -d -m 755 $OWNERSHIP ${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/stylesheet-images || exit 1

  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/stylesheet-images/caution.gif	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/stylesheet-images/caution.gif || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/stylesheet-images/home.gif	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/stylesheet-images/home.gif || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/stylesheet-images/important.gif	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/stylesheet-images/important.gif || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/stylesheet-images/next.gif	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/stylesheet-images/next.gif || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/stylesheet-images/note.gif	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/stylesheet-images/note.gif || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/stylesheet-images/prev.gif	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/stylesheet-images/prev.gif || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/stylesheet-images/tip.gif	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/stylesheet-images/tip.gif || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/stylesheet-images/toc-blank.gif	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/stylesheet-images/toc-blank.gif || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/stylesheet-images/toc-minus.gif	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/stylesheet-images/toc-minus.gif || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/stylesheet-images/toc-plus.gif	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/stylesheet-images/toc-plus.gif || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/stylesheet-images/up.gif	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/stylesheet-images/up.gif || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/stylesheet-images/warning.gif	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/stylesheet-images/warning.gif || exit 1


  install -d -m 755 $OWNERSHIP ${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/images || exit 1

  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/images/cluster.eps	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/images/cluster.eps || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/images/si_image1.eps	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/images/si_image1.eps || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/images/si_image1.jpg	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/images/si_image1.jpg || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/images/cluster.jpg	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/images/cluster.jpg || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/images/si_image2.eps	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/images/si_image2.eps || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/images/si_image2.jpg	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/images/si_image2.jpg || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/images/si_image3.jpg	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/images/si_image3.jpg || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/images/si_image3.eps	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/images/si_image3.eps || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/images/si_image4.jpg	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/images/si_image4.jpg || exit 1
  install -m 444 $OWNERSHIP $INSTALL_DIR/doc/manual/html/images/si_image4.eps	${prefix}/share/doc/$PACKAGE_NAME-$VERSION/manual/html/images/si_image4.eps || exit 1


fi
### END install documentation ###

# wrap up
[ $QUIET = "false" ] && echo
[ $QUIET = "false" ] && echo "All done!  Please read the manual before using SystemImager."
[ $QUIET = "false" ] && echo "See ${prefix}/share/doc/${PACKAGE_NAME}-${VERSION}/ for all documentation."
[ $QUIET = "false" ] && echo


exit 0
